{#
	Common vars
	* block    [NS\CmsBundle\Entity\Block]
	* settings [NS\FeedbackBundle\Block\Settings\FeedbackBlockSettingsModel]
	    * formId     [int]
	    * ignorePost [boolean]

	Root-level vars
	* form     [Symfony\Component\Form\FormView]
	* success  [boolean]
	* uid      [string]
	* ajaxUrl  [string]
#}

<img src="{{ asset('bundles/wsfront/images/request.png') }}" class="request-image">
{% if success %}
  <p>Ваше сообщение успешно отправлено!</p>
{% else %}
  <a href="#" id="make-order" class="button">Оставить заявку</a><br>
  <a href="#" class="we-answer">Ответим на любые вопросы</a>

  <div id="feedback-window" class="modal">
    <div class="header">
      <h2>Задать вопрос</h2>
    </div>
    <form method="post" class="{{ uid }}">
      {{ form_widget(form) }}
      <input type="submit" value="Отправить">
    </form>
  </div>

  {# Asynchronous usage example #}
  <script>
    (function ($) {
      var form = $('.{{ uid }}');
      form.submit(function () {
        $.post('{{ ajaxUrl }}', $('.{{ uid }}').serialize());
        $('#feedback-window').trigger('closeModal');
        return false;
      });

      $('#feedback-window').easyModal({
        top: 180,
        overlayOpacity: 0.3,
        overlayColor: "#CCC",
        closeOnEscape: true
      });

      $('#make-order').on('click', function (e) {
        e.preventDefault();
        $('#feedback-window').trigger('openModal');
      });

    })(jQuery);
  </script>
{% endif %}
